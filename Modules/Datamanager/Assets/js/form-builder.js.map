{"version":3,"sources":["form-builder.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"form-builder.js","sourcesContent":["(function() {\n\n    var copyObjectToScope;\n\n    copyObjectToScope = function(object, scope) {\n        /*\n         Copy object (ng-repeat=\"object in objects\") to scope without `hashKey`.\n         */\n        var key, value;\n        for (key in object) {\n            value = object[key];\n            if (key !== '$$hashKey') {\n                scope[key] = value;\n            }\n        }\n    };\n\n    angular.module('builder.controller', ['builder.provider']).controller('fbFormObjectEditableController', [\n        '$scope', '$injector', function($scope, $injector) {\n            var $builder;\n            $builder = $injector.get('$builder');\n            $scope.setupScope = function(formObject) {\n\n                /*\n                 1. Copy origin formObject (ng-repeat=\"object in formObjects\") to scope.\n                 2. Setup optionsText with formObject.options.\n                 3. Watch scope.label, .description, .placeholder, .required, .options then copy to origin formObject.\n                 4. Watch scope.optionsText then convert to scope.options.\n                 5. setup validationOptions\n                 */\n                var component;\n                copyObjectToScope(formObject, $scope);\n                $scope.optionsText = formObject.options.join('\\n');\n                $scope.$watch('[label, name, description, placeholder, required, options, validation]', function() {\n                    formObject.label = $scope.label;\n                    formObject.name = $scope.name;\n                    formObject.description = $scope.description;\n                    formObject.placeholder = $scope.placeholder;\n                    formObject.required = $scope.required;\n                    formObject.options = $scope.options;\n                    return formObject.validation = $scope.validation;\n                }, true);\n                $scope.$watch('optionsText', function(text) {\n                    var x;\n                    $scope.options = (function() {\n                        var _i, _len, _ref, _results;\n                        _ref = text.split('\\n');\n                        _results = [];\n                        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n                            x = _ref[_i];\n                            if (x.length > 0) {\n                                _results.push(x);\n                            }\n                        }\n                        return _results;\n                    })();\n                    return $scope.inputText = $scope.options[0];\n                });\n                component = $builder.components[formObject.component];\n                return $scope.validationOptions = component.validationOptions;\n            };\n            return $scope.data = {\n                model: null,\n                backup: function() {\n\n                    /*\n                     Backup input value.\n                     */\n                    return this.model = {\n                        label: $scope.label,\n                        name: $scope.name,\n                        description: $scope.description,\n                        placeholder: $scope.placeholder,\n                        required: $scope.required,\n                        optionsText: $scope.optionsText,\n                        validation: $scope.validation\n                    };\n                },\n                rollback: function() {\n\n                    /*\n                     Rollback input value.\n                     */\n                    if (!this.model) {\n                        return;\n                    }\n                    $scope.label = this.model.label;\n                    $scope.name = this.model.name;\n                    $scope.description = this.model.description;\n                    $scope.placeholder = this.model.placeholder;\n                    $scope.required = this.model.required;\n                    $scope.optionsText = this.model.optionsText;\n                    return $scope.validation = this.model.validation;\n                }\n            };\n        }\n    ]).controller('fbComponentsController', [\n        '$scope', '$injector', function($scope, $injector) {\n            var $builder;\n            $builder = $injector.get('$builder');\n            $scope.selectGroup = function($event, group) {\n                var component, name, _ref, _results;\n                if ($event != null) {\n                    $event.preventDefault();\n                }\n                $scope.activeGroup = group;\n                $scope.components = [];\n                _ref = $builder.components;\n                _results = [];\n                for (name in _ref) {\n                    component = _ref[name];\n                    if (component.group === group) {\n                        _results.push($scope.components.push(component));\n                    }\n                }\n                return _results;\n            };\n            $scope.groups = $builder.groups;\n            $scope.activeGroup = $scope.groups[0];\n            $scope.allComponents = $builder.components;\n            return $scope.$watch('allComponents', function() {\n                return $scope.selectGroup(null, $scope.activeGroup);\n            });\n        }\n    ]).controller('fbComponentController', [\n        '$scope', function($scope) {\n            return $scope.copyObjectToScope = function(object) {\n                return copyObjectToScope(object, $scope);\n            };\n        }\n    ]).controller('fbFormController', [\n        '$scope', '$injector', function($scope, $injector) {\n            var $builder, $timeout;\n            $builder = $injector.get('$builder');\n            $timeout = $injector.get('$timeout');\n            if ($scope.input == null) {\n                $scope.input = [];\n            }\n            return $scope.$watch('form', function() {\n                if ($scope.input.length > $scope.form.length) {\n                    $scope.input.splice($scope.form.length);\n                }\n                return $timeout(function() {\n                    return $scope.$broadcast($builder.broadcastChannel.updateInput);\n                });\n            }, true);\n        }\n    ]).controller('fbFormObjectController', [\n        '$scope', '$injector', function($scope, $injector) {\n            var $builder;\n            $builder = $injector.get('$builder');\n            $scope.copyObjectToScope = function(object) {\n                return copyObjectToScope(object, $scope);\n            };\n            return $scope.updateInput = function(value) {\n\n                /*\n                 Copy current scope.input[X] to $parent.input.\n                 @param value: The input value.\n                 */\n                var input;\n                input = {\n                    id: $scope.formObject.id,\n                    name: $scope.formObject.name,\n                    label: $scope.formObject.label,\n                    value: value != null ? value : ''\n                };\n                return $scope.$parent.input.splice($scope.$index, 1, input);\n            };\n        }\n    ]);\n\n}).call(this);\n\n(function() {\n    angular.module('builder.directive', ['builder.provider', 'builder.controller', 'builder.drag', 'validator']).directive('fbBuilder', [\n        '$injector', function($injector) {\n            var $builder, $drag;\n            $builder = $injector.get('$builder');\n            $drag = $injector.get('$drag');\n            return {\n                restrict: 'A',\n                scope: {\n                    fbBuilder: '='\n                },\n                template: \"<div class='form-horizontal'>\\n    <div class='fb-form-object-editable' ng-repeat=\\\"object in formObjects\\\"\\n        fb-form-object-editable=\\\"object\\\"></div>\\n</div>\",\n                link: function(scope, element, attrs) {\n                    var beginMove, _base, _name;\n                    scope.formName = attrs.fbBuilder;\n                    if ((_base = $builder.forms)[_name = scope.formName] == null) {\n                        _base[_name] = [];\n                    }\n                    scope.formObjects = $builder.forms[scope.formName];\n                    beginMove = true;\n                    $(element).addClass('fb-builder');\n                    return $drag.droppable($(element), {\n                        move: function(e) {\n                            var $empty, $formObject, $formObjects, height, index, offset, positions, _i, _j, _ref, _ref1;\n                            if (beginMove) {\n                                $(\"div.fb-form-object-editable\").popover('hide');\n                                beginMove = false;\n                            }\n                            $formObjects = $(element).find('.fb-form-object-editable:not(.empty,.dragging)');\n                            if ($formObjects.length === 0) {\n                                if ($(element).find('.fb-form-object-editable.empty').length === 0) {\n                                    $(element).find('>div:first').append($(\"<div class='fb-form-object-editable empty'></div>\"));\n                                }\n                                return;\n                            }\n                            positions = [];\n                            positions.push(-1000);\n                            for (index = _i = 0, _ref = $formObjects.length; _i < _ref; index = _i += 1) {\n                                $formObject = $($formObjects[index]);\n                                offset = $formObject.offset();\n                                height = $formObject.height();\n                                positions.push(offset.top + height / 2);\n                            }\n                            positions.push(positions[positions.length - 1] + 1000);\n                            for (index = _j = 1, _ref1 = positions.length; _j < _ref1; index = _j += 1) {\n                                if (e.pageY > positions[index - 1] && e.pageY <= positions[index]) {\n                                    $(element).find('.empty').remove();\n                                    $empty = $(\"<div class='fb-form-object-editable empty'></div>\");\n                                    if (index - 1 < $formObjects.length) {\n                                        $empty.insertBefore($($formObjects[index - 1]));\n                                    } else {\n                                        $empty.insertAfter($($formObjects[index - 2]));\n                                    }\n                                    break;\n                                }\n                            }\n                        },\n                        out: function() {\n                            if (beginMove) {\n                                $(\"div.fb-form-object-editable\").popover('hide');\n                                beginMove = false;\n                            }\n                            return $(element).find('.empty').remove();\n                        },\n                        up: function(e, isHover, draggable) {\n                            var formObject, newIndex, oldIndex;\n                            beginMove = true;\n                            if (!$drag.isMouseMoved()) {\n                                $(element).find('.empty').remove();\n                                return;\n                            }\n                            if (!isHover && draggable.mode === 'drag') {\n                                formObject = draggable.object.formObject;\n                                if (formObject.editable) {\n                                    $builder.removeFormObject(attrs.fbBuilder, formObject.index);\n                                }\n                            } else if (isHover) {\n                                if (draggable.mode === 'mirror') {\n                                    $builder.insertFormObject(scope.formName, $(element).find('.empty').index('.fb-form-object-editable'), {\n                                        component: draggable.object.componentName\n                                    });\n                                }\n                                if (draggable.mode === 'drag') {\n                                    oldIndex = draggable.object.formObject.index;\n                                    newIndex = $(element).find('.empty').index('.fb-form-object-editable');\n                                    if (oldIndex < newIndex) {\n                                        newIndex--;\n                                    }\n                                    $builder.updateFormObjectIndex(scope.formName, oldIndex, newIndex);\n                                }\n                            }\n                            return $(element).find('.empty').remove();\n                        }\n                    });\n                }\n            };\n        }\n    ]).directive('fbFormObjectEditable', [\n        '$injector', function($injector) {\n            var $builder, $compile, $drag, $validator;\n            $builder = $injector.get('$builder');\n            $drag = $injector.get('$drag');\n            $compile = $injector.get('$compile');\n            $validator = $injector.get('$validator');\n            return {\n                restrict: 'A',\n                controller: 'fbFormObjectEditableController',\n                scope: {\n                    formObject: '=fbFormObjectEditable'\n                },\n                link: function(scope, element) {\n                    var popover;\n                    scope.inputArray = [];\n                    scope.$component = $builder.components[scope.formObject.component];\n                    scope.setupScope(scope.formObject);\n                    scope.$watch('$component.template', function(template) {\n                        var view;\n                        if (!template) {\n                            return;\n                        }\n                        view = $compile(template)(scope);\n                        return $(element).html(view);\n                    });\n                    $(element).on('click', function() {\n                        return false;\n                    });\n                    $drag.draggable($(element), {\n                        object: {\n                            formObject: scope.formObject\n                        }\n                    });\n                    if (!scope.formObject.editable) {\n                        return;\n                    }\n                    popover = {};\n                    scope.$watch('$component.popoverTemplate', function(template) {\n                        if (!template) {\n                            return;\n                        }\n                        $(element).removeClass(popover.id);\n                        popover = {\n                            id: \"fb-\" + (Math.random().toString().substr(2)),\n                            isClickedSave: false,\n                            view: null,\n                            html: template\n                        };\n                        popover.html = $(popover.html).addClass(popover.id);\n                        popover.view = $compile(popover.html)(scope);\n                        $(element).addClass(popover.id);\n                        return $(element).popover({\n                            html: true,\n                            title: scope.$component.label,\n                            content: popover.view,\n                            container: 'body'\n                        });\n                    });\n                    scope.popover = {\n                        save: function($event) {\n\n                            /*\n                             The save event of the popover.\n                             */\n                            $event.preventDefault();\n                            $validator.validate(scope).success(function() {\n                                popover.isClickedSave = true;\n                                return $(element).popover('hide');\n                            });\n                        },\n                        remove: function($event) {\n\n                            /*\n                             The delete event of the popover.\n                             */\n                            $event.preventDefault();\n                            $builder.removeFormObject(scope.$parent.formName, scope.$parent.$index);\n                            $(element).popover('hide');\n                        },\n                        shown: function() {\n\n                            /*\n                             The shown event of the popover.\n                             */\n                            scope.data.backup();\n                            return popover.isClickedSave = false;\n                        },\n                        cancel: function($event) {\n\n                            /*\n                             The cancel event of the popover.\n                             */\n                            scope.data.rollback();\n                            if ($event) {\n                                $event.preventDefault();\n                                $(element).popover('hide');\n                            }\n                        }\n                    };\n                    $(element).on('show.bs.popover', function() {\n                        var $popover, elementOrigin, popoverTop;\n                        if ($drag.isMouseMoved()) {\n                            return false;\n                        }\n                        $(\"div.fb-form-object-editable:not(.\" + popover.id + \")\").popover('hide');\n                        $popover = $(\"form.\" + popover.id).closest('.popover');\n                        if ($popover.length > 0) {\n                            elementOrigin = $(element).offset().top + $(element).height() / 2;\n                            popoverTop = elementOrigin - $popover.height() / 2;\n                            $popover.css({\n                                position: 'absolute',\n                                top: popoverTop\n                            });\n                            $popover.show();\n                            setTimeout(function() {\n                                $popover.addClass('in');\n                                return $(element).triggerHandler('shown.bs.popover');\n                            }, 0);\n                            return false;\n                        }\n                    });\n                    $(element).on('shown.bs.popover', function() {\n                        $(\".popover .\" + popover.id + \" input:first\").select();\n                        scope.$apply(function() {\n                            return scope.popover.shown();\n                        });\n                    });\n                    return $(element).on('hide.bs.popover', function() {\n                        var $popover;\n                        $popover = $(\"form.\" + popover.id).closest('.popover');\n                        if (!popover.isClickedSave) {\n                            if (scope.$$phase || scope.$root.$$phase) {\n                                scope.popover.cancel();\n                            } else {\n                                scope.$apply(function() {\n                                    return scope.popover.cancel();\n                                });\n                            }\n                        }\n                        $popover.removeClass('in');\n                        setTimeout(function() {\n                            return $popover.hide();\n                        }, 300);\n                        return false;\n                    });\n                }\n            };\n        }\n    ]).directive('fbComponents', function() {\n        return {\n            restrict: 'A',\n            template: \"<ul ng-if=\\\"groups.length > 1\\\" class=\\\"nav nav-tabs nav-justified\\\">\\n    <li ng-repeat=\\\"group in groups\\\" ng-class=\\\"{active:activeGroup==group}\\\">\\n        <a href='#' ng-click=\\\"selectGroup($event, group)\\\">{{group}}</a>\\n    </li>\\n</ul>\\n<div class='form-horizontal'>\\n    <div class='fb-component' ng-repeat=\\\"component in components\\\"\\n        fb-component=\\\"component\\\"></div>\\n</div>\",\n            controller: 'fbComponentsController'\n        };\n    }).directive('fbComponent', [\n        '$injector', function($injector) {\n            var $builder, $compile, $drag;\n            $builder = $injector.get('$builder');\n            $drag = $injector.get('$drag');\n            $compile = $injector.get('$compile');\n            return {\n                restrict: 'A',\n                scope: {\n                    component: '=fbComponent'\n                },\n                controller: 'fbComponentController',\n                link: function(scope, element) {\n                    scope.copyObjectToScope(scope.component);\n                    $drag.draggable($(element), {\n                        mode: 'mirror',\n                        defer: false,\n                        object: {\n                            componentName: scope.component.name\n                        }\n                    });\n\n                    return scope.$watch('component.template', function(template) {\n                        var view;\n                        if (!template) {\n                            return;\n                        }\n                        view = $compile(template)(scope);\n                        return $(element).html(view);\n                    });\n                }\n            };\n        }\n    ]).directive('fbForm', [\n        '$injector', function($injector) {\n            return {\n                restrict: 'A',\n                require: 'ngModel',\n                scope: {\n                    formName: '@fbForm',\n                    input: '=ngModel',\n                    \"default\": '=fbDefault'\n                },\n                template: \"<div class='fb-form-object' ng-repeat=\\\"object in form\\\" fb-form-object=\\\"object\\\"></div>\",\n                controller: 'fbFormController',\n                link: function(scope, element, attrs) {\n                    var $builder, _base, _name;\n                    $builder = $injector.get('$builder');\n                    if ((_base = $builder.forms)[_name = scope.formName] == null) {\n                        _base[_name] = [];\n                    }\n                    return scope.form = $builder.forms[scope.formName];\n                }\n            };\n        }\n    ]).directive('fbFormObject', [\n        '$injector', function($injector) {\n            var $builder, $compile, $parse;\n            $builder = $injector.get('$builder');\n            $compile = $injector.get('$compile');\n            $parse = $injector.get('$parse');\n            return {\n                restrict: 'A',\n                controller: 'fbFormObjectController',\n                link: function(scope, element, attrs) {\n                    scope.formObject = $parse(attrs.fbFormObject)(scope);\n                    scope.$component = $builder.components[scope.formObject.component];\n                    scope.$on($builder.broadcastChannel.updateInput, function() {\n                        return scope.updateInput(scope.inputText);\n                    });\n                    if (scope.$component.arrayToText) {\n                        scope.inputArray = [];\n                        scope.$watch('inputArray', function(newValue, oldValue) {\n                            var checked, index;\n                            if (newValue === oldValue) {\n                                return;\n                            }\n                            checked = [];\n                            for (index in scope.inputArray) {\n                                if (scope.inputArray[index]) {\n                                    checked.push(scope.options[index]);\n                                }\n                            }\n                            return scope.inputText = checked.join(', ');\n                        }, true);\n                    }\n                    scope.$watch('inputText', function() {\n                        return scope.updateInput(scope.inputText);\n                    });\n                    scope.$watch(attrs.fbFormObject, function() {\n                        return scope.copyObjectToScope(scope.formObject);\n                    }, true);\n                    scope.$watch('$component.template', function(template) {\n                        var $input, $template, view;\n                        if (!template) {\n                            return;\n                        }\n                        $template = $(template);\n                        $input = $template.find(\"[ng-model='inputText']\");\n                        $input.attr({\n                            validator: '{{validation}}'\n                        });\n                        view = $compile($template)(scope);\n                        return $(element).html(view);\n                    });\n                    if (!scope.$component.arrayToText && scope.formObject.options.length > 0) {\n                        scope.inputText = scope.formObject.options[0];\n                    }\n                    return scope.$watch(\"default[\" + scope.formObject.id + \"]\", function(value) {\n                        if (!value) {\n                            return;\n                        }\n                        if (scope.$component.arrayToText) {\n                            return scope.inputArray = value;\n                        } else {\n                            return scope.inputText = value;\n                        }\n                    });\n                }\n            };\n        }\n    ]);\n\n}).call(this);\n\n(function() {\n    angular.module('builder.drag', []).provider('$drag', function() {\n        var $injector, $rootScope, delay;\n        $injector = null;\n        $rootScope = null;\n        this.data = {\n            draggables: {},\n            droppables: {}\n        };\n        this.mouseMoved = false;\n        this.isMouseMoved = (function(_this) {\n            return function() {\n                return _this.mouseMoved;\n            };\n        })(this);\n        this.hooks = {\n            down: {},\n            move: {},\n            up: {}\n        };\n        this.eventMouseMove = function() {};\n        this.eventMouseUp = function() {};\n        $((function(_this) {\n            return function() {\n                $(document).on('mousedown', function(e) {\n                    var func, key, _ref;\n                    _this.mouseMoved = false;\n                    _ref = _this.hooks.down;\n                    for (key in _ref) {\n                        func = _ref[key];\n                        func(e);\n                    }\n                });\n                $(document).on('mousemove', function(e) {\n                    var func, key, _ref;\n                    _this.mouseMoved = true;\n                    _ref = _this.hooks.move;\n                    for (key in _ref) {\n                        func = _ref[key];\n                        func(e);\n                    }\n                });\n                return $(document).on('mouseup', function(e) {\n                    var func, key, _ref;\n                    _ref = _this.hooks.up;\n                    for (key in _ref) {\n                        func = _ref[key];\n                        func(e);\n                    }\n                });\n            };\n        })(this));\n        this.currentId = 0;\n        this.getNewId = (function(_this) {\n            return function() {\n                return \"\" + (_this.currentId++);\n            };\n        })(this);\n        this.setupEasing = function() {\n            return jQuery.extend(jQuery.easing, {\n                easeOutQuad: function(x, t, b, c, d) {\n                    return -c * (t /= d) * (t - 2) + b;\n                }\n            });\n        };\n        this.setupProviders = function(injector) {\n\n            /*\n             Setup providers.\n             */\n            $injector = injector;\n            return $rootScope = $injector.get('$rootScope');\n        };\n        this.isHover = (function(_this) {\n            return function($elementA, $elementB) {\n\n                /*\n                 Is element A hover on element B?\n                 @param $elementA: jQuery object\n                 @param $elementB: jQuery object\n                 */\n                var isHover, offsetA, offsetB, sizeA, sizeB;\n                offsetA = $elementA.offset();\n                offsetB = $elementB.offset();\n                sizeA = {\n                    width: $elementA.width(),\n                    height: $elementA.height()\n                };\n                sizeB = {\n                    width: $elementB.width(),\n                    height: $elementB.height()\n                };\n                isHover = {\n                    x: false,\n                    y: false\n                };\n                isHover.x = offsetA.left > offsetB.left && offsetA.left < offsetB.left + sizeB.width;\n                isHover.x = isHover.x || offsetA.left + sizeA.width > offsetB.left && offsetA.left + sizeA.width < offsetB.left + sizeB.width;\n                if (!isHover) {\n                    return false;\n                }\n                isHover.y = offsetA.top > offsetB.top && offsetA.top < offsetB.top + sizeB.height;\n                isHover.y = isHover.y || offsetA.top + sizeA.height > offsetB.top && offsetA.top + sizeA.height < offsetB.top + sizeB.height;\n                return isHover.x && isHover.y;\n            };\n        })(this);\n        delay = function(ms, func) {\n            return setTimeout(function() {\n                return func();\n            }, ms);\n        };\n        this.autoScroll = {\n            up: false,\n            down: false,\n            scrolling: false,\n            scroll: (function(_this) {\n                return function() {\n                    _this.autoScroll.scrolling = true;\n                    if (_this.autoScroll.up) {\n                        $('html, body').dequeue().animate({\n                            scrollTop: $(window).scrollTop() - 50\n                        }, 100, 'easeOutQuad');\n                        return delay(100, function() {\n                            return _this.autoScroll.scroll();\n                        });\n                    } else if (_this.autoScroll.down) {\n                        $('html, body').dequeue().animate({\n                            scrollTop: $(window).scrollTop() + 50\n                        }, 100, 'easeOutQuad');\n                        return delay(100, function() {\n                            return _this.autoScroll.scroll();\n                        });\n                    } else {\n                        return _this.autoScroll.scrolling = false;\n                    }\n                };\n            })(this),\n            start: (function(_this) {\n                return function(e) {\n                    if (e.clientY < 50) {\n                        _this.autoScroll.up = true;\n                        _this.autoScroll.down = false;\n                        if (!_this.autoScroll.scrolling) {\n                            return _this.autoScroll.scroll();\n                        }\n                    } else if (e.clientY > $(window).innerHeight() - 50) {\n                        _this.autoScroll.up = false;\n                        _this.autoScroll.down = true;\n                        if (!_this.autoScroll.scrolling) {\n                            return _this.autoScroll.scroll();\n                        }\n                    } else {\n                        _this.autoScroll.up = false;\n                        return _this.autoScroll.down = false;\n                    }\n                };\n            })(this),\n            stop: (function(_this) {\n                return function() {\n                    _this.autoScroll.up = false;\n                    return _this.autoScroll.down = false;\n                };\n            })(this)\n        };\n        this.dragMirrorMode = (function(_this) {\n            return function($element, defer, object) {\n                var result;\n                if (defer == null) {\n                    defer = true;\n                }\n                result = {\n                    id: _this.getNewId(),\n                    mode: 'mirror',\n                    maternal: $element[0],\n                    element: null,\n                    object: object\n                };\n                $element.on('mousedown', function(e) {\n                    var $clone;\n                    e.preventDefault();\n                    $clone = $element.clone();\n                    result.element = $clone[0];\n                    $clone.addClass(\"fb-draggable form-horizontal prepare-dragging\");\n                    _this.hooks.move.drag = function(e, defer) {\n                        var droppable, id, _ref, _results;\n                        if ($clone.hasClass('prepare-dragging')) {\n                            $clone.css({\n                                width: $element.width(),\n                                height: $element.height()\n                            });\n                            $clone.removeClass('prepare-dragging');\n                            $clone.addClass('dragging');\n                            if (defer) {\n                                return;\n                            }\n                        }\n                        $clone.offset({\n                            left: e.pageX - $clone.width() / 2,\n                            top: e.pageY - $clone.height() / 2\n                        });\n                        _this.autoScroll.start(e);\n                        _ref = _this.data.droppables;\n                        _results = [];\n                        for (id in _ref) {\n                            droppable = _ref[id];\n                            if (_this.isHover($clone, $(droppable.element))) {\n                                _results.push(droppable.move(e, result));\n                            } else {\n                                _results.push(droppable.out(e, result));\n                            }\n                        }\n                        return _results;\n                    };\n                    _this.hooks.up.drag = function(e) {\n                        var droppable, id, isHover, _ref;\n                        _ref = _this.data.droppables;\n                        for (id in _ref) {\n                            droppable = _ref[id];\n                            isHover = _this.isHover($clone, $(droppable.element));\n                            droppable.up(e, isHover, result);\n                        }\n                        delete _this.hooks.move.drag;\n                        delete _this.hooks.up.drag;\n                        result.element = null;\n                        $clone.remove();\n                        return _this.autoScroll.stop();\n                    };\n                    $('body').append($clone);\n                    if (!defer) {\n                        return _this.hooks.move.drag(e, defer);\n                    }\n                });\n                return result;\n            };\n        })(this);\n        this.dragDragMode = (function(_this) {\n            return function($element, defer, object) {\n                var result;\n                if (defer == null) {\n                    defer = true;\n                }\n                result = {\n                    id: _this.getNewId(),\n                    mode: 'drag',\n                    maternal: null,\n                    element: $element[0],\n                    object: object\n                };\n                $element.addClass('fb-draggable');\n                $element.on('mousedown', function(e) {\n                    e.preventDefault();\n                    if ($element.hasClass('dragging')) {\n                        return;\n                    }\n                    $element.addClass('prepare-dragging');\n                    _this.hooks.move.drag = function(e, defer) {\n                        var droppable, id, _ref;\n                        if ($element.hasClass('prepare-dragging')) {\n                            $element.css({\n                                width: $element.width(),\n                                height: $element.height()\n                            });\n                            $element.removeClass('prepare-dragging');\n                            $element.addClass('dragging');\n                            if (defer) {\n                                return;\n                            }\n                        }\n                        $element.offset({\n                            left: e.pageX - $element.width() / 2,\n                            top: e.pageY - $element.height() / 2\n                        });\n                        _this.autoScroll.start(e);\n                        _ref = _this.data.droppables;\n                        for (id in _ref) {\n                            droppable = _ref[id];\n                            if (_this.isHover($element, $(droppable.element))) {\n                                droppable.move(e, result);\n                            } else {\n                                droppable.out(e, result);\n                            }\n                        }\n                    };\n                    _this.hooks.up.drag = function(e) {\n                        var droppable, id, isHover, _ref;\n                        _ref = _this.data.droppables;\n                        for (id in _ref) {\n                            droppable = _ref[id];\n                            isHover = _this.isHover($element, $(droppable.element));\n                            droppable.up(e, isHover, result);\n                        }\n                        delete _this.hooks.move.drag;\n                        delete _this.hooks.up.drag;\n                        $element.css({\n                            width: '',\n                            height: '',\n                            left: '',\n                            top: ''\n                        });\n                        $element.removeClass('dragging defer-dragging');\n                        return _this.autoScroll.stop();\n                    };\n                    if (!defer) {\n                        return _this.hooks.move.drag(e, defer);\n                    }\n                });\n                return result;\n            };\n        })(this);\n        this.dropMode = (function(_this) {\n            return function($element, options) {\n                var result;\n                result = {\n                    id: _this.getNewId(),\n                    element: $element[0],\n                    move: function(e, draggable) {\n                        return $rootScope.$apply(function() {\n                            return typeof options.move === \"function\" ? options.move(e, draggable) : void 0;\n                        });\n                    },\n                    up: function(e, isHover, draggable) {\n                        return $rootScope.$apply(function() {\n                            return typeof options.up === \"function\" ? options.up(e, isHover, draggable) : void 0;\n                        });\n                    },\n                    out: function(e, draggable) {\n                        return $rootScope.$apply(function() {\n                            return typeof options.out === \"function\" ? options.out(e, draggable) : void 0;\n                        });\n                    }\n                };\n                return result;\n            };\n        })(this);\n        this.draggable = (function(_this) {\n            return function($element, options) {\n                var draggable, element, result, _i, _j, _len, _len1;\n                if (options == null) {\n                    options = {};\n                }\n\n                /*\n                 Make the element could be drag.\n                 @param element: The jQuery element.\n                 @param options: Options\n                 mode: 'drag' [default], 'mirror'\n                 defer: yes/no. defer dragging\n                 object: custom information\n                 */\n                result = [];\n                if (options.mode === 'mirror') {\n                    for (_i = 0, _len = $element.length; _i < _len; _i++) {\n                        element = $element[_i];\n                        draggable = _this.dragMirrorMode($(element), options.defer, options.object);\n                        result.push(draggable.id);\n                        _this.data.draggables[draggable.id] = draggable;\n                    }\n                } else {\n                    for (_j = 0, _len1 = $element.length; _j < _len1; _j++) {\n                        element = $element[_j];\n                        draggable = _this.dragDragMode($(element), options.defer, options.object);\n                        result.push(draggable.id);\n                        _this.data.draggables[draggable.id] = draggable;\n                    }\n                }\n                return result;\n            };\n        })(this);\n        this.droppable = (function(_this) {\n            return function($element, options) {\n                var droppable, element, result, _i, _len;\n                if (options == null) {\n                    options = {};\n                }\n\n                /*\n                 Make the element coulde be drop.\n                 @param $element: The jQuery element.\n                 @param options: The droppable options.\n                 move: The custom mouse move callback. (e, draggable)->\n                 up: The custom mouse up callback. (e, isHover, draggable)->\n                 out: The custom mouse out callback. (e, draggable)->\n                 */\n                result = [];\n                for (_i = 0, _len = $element.length; _i < _len; _i++) {\n                    element = $element[_i];\n                    droppable = _this.dropMode($(element), options);\n                    result.push(droppable);\n                    _this.data.droppables[droppable.id] = droppable;\n                }\n                return result;\n            };\n        })(this);\n        this.get = function($injector) {\n            this.setupEasing();\n            this.setupProviders($injector);\n            return {\n                isMouseMoved: this.isMouseMoved,\n                data: this.data,\n                draggable: this.draggable,\n                droppable: this.droppable\n            };\n        };\n        this.get.$inject = ['$injector'];\n        this.$get = this.get;\n    });\n\n}).call(this);\n\n(function() {\n    angular.module('builder', ['builder.directive']);\n\n}).call(this);\n\n\n/*\n component:\n It is like a class.\n The base components are textInput, textArea, select, check, radio.\n User can custom the form with components.\n formObject:\n It is like an object (an instance of the component).\n User can custom the label, description, required and validation of the input.\n form:\n This is for end-user. There are form groups int the form.\n They can input the value to the form.\n */\n\n(function() {\n    var __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\n    angular.module('builder.provider', []).provider('$builder', function() {\n        var $http, $injector, $templateCache;\n        $injector = null;\n        $http = null;\n        $templateCache = null;\n        this.version = '0.0.2';\n        this.components = {};\n        this.groups = [];\n        this.broadcastChannel = {\n            updateInput: '$updateInput'\n        };\n        this.forms = {\n            \"default\": []\n        };\n        this.formsId = {\n            \"default\": 0\n        };\n        this.convertComponent = function(name, component) {\n            var result, _ref, _ref1, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9;\n            result = {\n                name: name,\n                group: (_ref = component.group) != null ? _ref : 'Default',\n                label: (_ref1 = component.label) != null ? _ref1 : '',\n                description: (_ref2 = component.description) != null ? _ref2 : '',\n                placeholder: (_ref3 = component.placeholder) != null ? _ref3 : '',\n                editable: (_ref4 = component.editable) != null ? _ref4 : true,\n                required: (_ref5 = component.required) != null ? _ref5 : false,\n                validation: (_ref6 = component.validation) != null ? _ref6 : '/.*/',\n                validationOptions: (_ref7 = component.validationOptions) != null ? _ref7 : [],\n                options: (_ref8 = component.options) != null ? _ref8 : [],\n                arrayToText: (_ref9 = component.arrayToText) != null ? _ref9 : false,\n                template: component.template,\n                templateUrl: component.templateUrl,\n                popoverTemplate: component.popoverTemplate,\n                popoverTemplateUrl: component.popoverTemplateUrl\n            };\n            if (!result.template && !result.templateUrl) {\n                console.error(\"The template is empty.\");\n            }\n            if (!result.popoverTemplate && !result.popoverTemplateUrl) {\n                console.error(\"The popoverTemplate is empty.\");\n            }\n            return result;\n        };\n        this.convertFormObject = function(name, formObject) {\n            var component, exist, form, result, _i, _len, _ref, _ref1, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9, _ref10;\n            if (formObject == null) {\n                formObject = {};\n            }\n            component = this.components[formObject.component];\n            if (component == null) {\n                throw \"The component \" + formObject.component + \" was not registered.\";\n            }\n            if (formObject.id) {\n                exist = false;\n                _ref = this.forms[name];\n                for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n                    form = _ref[_i];\n                    if (!(formObject.id <= form.id)) {\n                        continue;\n                    }\n                    formObject.id = this.formsId[name]++;\n                    exist = true;\n                    break;\n                }\n                if (!exist) {\n                    this.formsId[name] = formObject.id + 1;\n                }\n            }\n            result = {\n                id: (_ref1 = formObject.id) != null ? _ref1 : this.formsId[name]++,\n                component: formObject.component,\n                editable: (_ref2 = formObject.editable) != null ? _ref2 : component.editable,\n                index: (_ref3 = formObject.index) != null ? _ref3 : 0,\n                label: (_ref4 = formObject.label) != null ? _ref4 : component.label,\n                description: (_ref5 = formObject.description) != null ? _ref5 : component.description,\n                placeholder: (_ref6 = formObject.placeholder) != null ? _ref6 : component.placeholder,\n                options: (_ref7 = formObject.options) != null ? _ref7 : component.options,\n                required: (_ref8 = formObject.required) != null ? _ref8 : component.required,\n                validation: (_ref9 = formObject.validation) != null ? _ref9 : component.validation,\n                name: (_ref10 = formObject.name) != null ? _ref10 : component.name,\n            };\n            return result;\n        };\n        this.reindexFormObject = (function(_this) {\n            return function(name) {\n                var formObjects, index, _i, _ref;\n                formObjects = _this.forms[name];\n                for (index = _i = 0, _ref = formObjects.length; _i < _ref; index = _i += 1) {\n                    formObjects[index].index = index;\n                }\n            };\n        })(this);\n        this.setupProviders = (function(_this) {\n            return function(injector) {\n                $injector = injector;\n                $http = $injector.get('$http');\n                return $templateCache = $injector.get('$templateCache');\n            };\n        })(this);\n        this.loadTemplate = function(component) {\n\n            /*\n             Load template for components.\n             @param component: {object} The component of $builder.\n             */\n            if (component.template == null) {\n                $http.get(component.templateUrl, {\n                    cache: $templateCache\n                }).success(function(template) {\n                    return component.template = template;\n                });\n            }\n            if (component.popoverTemplate == null) {\n                return $http.get(component.popoverTemplateUrl, {\n                    cache: $templateCache\n                }).success(function(template) {\n                    return component.popoverTemplate = template;\n                });\n            }\n        };\n        this.registerComponent = (function(_this) {\n            return function(name, component) {\n                var newComponent, _ref;\n                if (component == null) {\n                    component = {};\n                }\n\n                /*\n                 Register the component for form-builder.\n                 @param name: The component name.\n                 @param component: The component object.\n                 group: {string} The component group.\n                 label: {string} The label of the input.\n                 description: {string} The description of the input.\n                 placeholder: {string} The placeholder of the input.\n                 editable: {bool} Is the form object editable?\n                 required: {bool} Is the form object required?\n                 validation: {string} angular-validator. \"/regex/\" or \"[rule1, rule2]\". (default is RegExp(.*))\n                 validationOptions: {array} [{rule: angular-validator, label: 'option label'}] the options for the validation. (default is [])\n                 options: {array} The input options.\n                 arrayToText: {bool} checkbox could use this to convert input (default is no)\n                 template: {string} html template\n                 templateUrl: {string} The url of the template.\n                 popoverTemplate: {string} html template\n                 popoverTemplateUrl: {string} The url of the popover template.\n                 */\n                if (_this.components[name] == null) {\n                    newComponent = _this.convertComponent(name, component);\n                    _this.components[name] = newComponent;\n                    if ($injector != null) {\n                        _this.loadTemplate(newComponent);\n                    }\n                    if (_ref = newComponent.group, __indexOf.call(_this.groups, _ref) < 0) {\n                        _this.groups.push(newComponent.group);\n                    }\n                } else {\n                    console.error(\"The component \" + name + \" was registered.\");\n                }\n            };\n        })(this);\n        this.addFormObject = (function(_this) {\n            return function(name, formObject) {\n                var _base;\n                if (formObject == null) {\n                    formObject = {};\n                }\n\n                /*\n                 Insert the form object into the form at last.\n                 */\n                if ((_base = _this.forms)[name] == null) {\n                    _base[name] = [];\n                }\n                return _this.insertFormObject(name, _this.forms[name].length, formObject);\n            };\n        })(this);\n        this.insertFormObject = (function(_this) {\n            return function(name, index, formObject) {\n                var _base, _base1;\n                if (formObject == null) {\n                    formObject = {};\n                }\n\n                /*\n                 Insert the form object into the form at {index}.\n                 @param name: The form name.\n                 @param index: The form object index.\n                 @param form: The form object.\n                 id: {int} The form object id. It will be generate by $builder if not asigned.\n                 component: {string} The component name\n                 editable: {bool} Is the form object editable? (default is yes)\n                 label: {string} The form object label.\n                 name: {string} The form object label.\n                 description: {string} The form object description.\n                 placeholder: {string} The form object placeholder.\n                 options: {array} The form object options.\n                 required: {bool} Is the form object required? (default is no)\n                 validation: {string} angular-validator. \"/regex/\" or \"[rule1, rule2]\".\n                 [index]: {int} The form object index. It will be updated by $builder.\n                 @return: The form object.\n                 */\n                if ((_base = _this.forms)[name] == null) {\n                    _base[name] = [];\n                }\n                if ((_base1 = _this.formsId)[name] == null) {\n                    _base1[name] = 0;\n                }\n                if (index > _this.forms[name].length) {\n                    index = _this.forms[name].length;\n                } else if (index < 0) {\n                    index = 0;\n                }\n                _this.forms[name].splice(index, 0, _this.convertFormObject(name, formObject));\n                _this.reindexFormObject(name);\n                return _this.forms[name][index];\n            };\n        })(this);\n        this.removeFormObject = (function(_this) {\n            return function(name, index) {\n\n                /*\n                 Remove the form object by the index.\n                 @param name: The form name.\n                 @param index: The form object index.\n                 */\n                var formObjects;\n                formObjects = _this.forms[name];\n                formObjects.splice(index, 1);\n                return _this.reindexFormObject(name);\n            };\n        })(this);\n        this.updateFormObjectIndex = (function(_this) {\n            return function(name, oldIndex, newIndex) {\n\n                /*\n                 Update the index of the form object.\n                 @param name: The form name.\n                 @param oldIndex: The old index.\n                 @param newIndex: The new index.\n                 */\n                var formObject, formObjects;\n                if (oldIndex === newIndex) {\n                    return;\n                }\n                formObjects = _this.forms[name];\n                formObject = formObjects.splice(oldIndex, 1)[0];\n                formObjects.splice(newIndex, 0, formObject);\n                return _this.reindexFormObject(name);\n            };\n        })(this);\n        this.$get = [\n            '$injector', (function(_this) {\n                return function($injector) {\n                    var component, name, _ref;\n                    _this.setupProviders($injector);\n                    _ref = _this.components;\n                    for (name in _ref) {\n                        component = _ref[name];\n                        _this.loadTemplate(component);\n                    }\n                    return {\n                        version: _this.version,\n                        components: _this.components,\n                        groups: _this.groups,\n                        forms: _this.forms,\n                        broadcastChannel: _this.broadcastChannel,\n                        registerComponent: _this.registerComponent,\n                        addFormObject: _this.addFormObject,\n                        insertFormObject: _this.insertFormObject,\n                        removeFormObject: _this.removeFormObject,\n                        updateFormObjectIndex: _this.updateFormObjectIndex\n                    };\n                };\n            })(this)\n        ];\n    });\n\n}).call(this);"],"sourceRoot":"/source/"}